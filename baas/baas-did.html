<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#"><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <title>DID Micro Service | Metaverse Docs</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="https://docs.mvs.org/baas/baas-did.html">
  <!-- Alternative links -->
  
    
      <link rel="alternative" hreflang="en" href="https://docs.mvs.org/baas/baas-did.html">
    
      <link rel="alternative" hreflang="zh-cn" href="https://docs.mvs.org/zh-cn/baas/baas-did.html">
    
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/icon/mstile-144x144.png">
  <!-- CSS -->
  <!-- build:css build/css/navy.css -->
  <link rel="stylesheet" href="/css/navy.css">
  <!-- endbuild -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
  <!-- RSS -->
  <link rel="alternate" href="/atom.xml" title="Metaverse Docs">
  <!-- Open Graph -->
  <meta name="description" content="Introduction DID micro service provides API for exchanges to allow their customers to register DID and bind DID to customer’s wallet. Exchanges can implement the same feature according to this documem">
<meta property="og:type" content="website">
<meta property="og:title" content="DID Micro Service">
<meta property="og:url" content="https://docs.mvs.org/baas/baas-did.html">
<meta property="og:site_name" content="Metaverse Docs">
<meta property="og:description" content="Introduction DID micro service provides API for exchanges to allow their customers to register DID and bind DID to customer’s wallet. Exchanges can implement the same feature according to this documem">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-06-21T08:07:18.969Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DID Micro Service">
<meta name="twitter:description" content="Introduction DID micro service provides API for exchanges to allow their customers to register DID and bind DID to customer’s wallet. Exchanges can implement the same feature according to this documem">
<meta name="twitter:site" content="mvs_org">
<meta property="fb:admins" content="100006665201854">
  <!-- Google Analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-99097230-2', 'auto');
  ga('send', 'pageview');
</script>

</head>

<body>
  <div id="container">
    <header id="header" class="wrapper">
  <div id="header-inner" class="inner">
    <h1 id="logo-wrap">
      <a href="/" id="logo">Hexo</a>
    </h1>
    <nav id="main-nav">
      <a href="/docs/" class="main-nav-link">Docs</a><a href="/api_v3/" class="main-nav-link">API v3</a><a href="/baas/" class="main-nav-link">BaaS</a><a href="/developers/" class="main-nav-link">Developers</a><a href="/faq/" class="main-nav-link">FAQ</a><a href="/news/" class="main-nav-link">Releases</a>
      <a href="https://github.com/mvs-org/metaverse" class="main-nav-link"><i class="fa fa-github-alt"></i></a>
      <div id="search-input-wrap">
        <div id="search-input-icon">
          <i class="fa fa-search"></i>
        </div>
        <input type="search" id="search-input" placeholder="Search...">
      </div>
    </nav>
    <div id="lang-select-wrap">
      <label id="lang-select-label"><i class="fa fa-globe"></i><span>English</span></label>
      <select id="lang-select" data-canonical="baas/baas-did.html">
        
          <option value="en" selected>English</option>
        
          <option value="zh-cn">简体中文</option>
        
      </select>
    </div>
    <a id="mobile-nav-toggle">
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
    </a>
  </div>
</header>

    <div id="content-wrap">
  <div id="content" class="wrapper">
    <div id="content-inner">
      <article class="article-container" itemscope itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
            <div class="inner">
              <header class="article-header">
                <h1 class="article-title" itemprop="name">DID Micro Service</h1>
                <a href="https://github.com/mvs-org/docs-mvs-org/edit/master/source/baas/baas-did.md" class="article-edit-link" title="Improve this doc"><i class="fa fa-pencil"></i></a>
              </header>
              <div class="article-content" itemprop="articleBody">
                <h2 id="Introduction" class="article-heading"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction<a class="article-anchor" href="#Introduction" aria-hidden="true"></a></h2><hr>
<p>DID micro service provides API for exchanges to allow their customers to register DID and bind DID to customer’s wallet.</p>
<p>Exchanges can implement the same feature according to this documemt.</p>
<p>Related MVS commands:</p>
<blockquote>
<p>getnewaddress<br>registerdid<br>didchangeaddress<br>getdid<br>getpublickey<br>getnewmultisig<br>sendrawtx<br>send  </p>
</blockquote>
<p>For details of these command, please refer to <a href="https://docs.mvs.org/api_v2/">API Document</a>。</p>
<h2 id="User-Case" class="article-heading"><a href="#User-Case" class="headerlink" title="User Case"></a>User Case<a class="article-anchor" href="#User-Case" aria-hidden="true"></a></h2><hr>
<p>In the following user case, two actors are involed exchange and user <code>Alice</code>。</p>
<h3 id="User-requests-registering-an-DID" class="article-heading"><a href="#User-requests-registering-an-DID" class="headerlink" title="User requests registering an DID"></a>User requests registering an DID<a class="article-anchor" href="#User-requests-registering-an-DID" aria-hidden="true"></a></h3><p><code>Alice</code> request registering an DID named <code>Alias@Alice</code> on exchange’s website or app.</p>
<h3 id="Exchange-registers-DID" class="article-heading"><a href="#Exchange-registers-DID" class="headerlink" title="Exchange registers DID"></a>Exchange registers DID<a class="article-anchor" href="#Exchange-registers-DID" aria-hidden="true"></a></h3><p>Exchange generates a new address by <code>getnewaddress</code> and registers DID named <code>Alias@Alice</code> to it.</p>
<h3 id="User-binds-DID-to-user’s-wallet" class="article-heading"><a href="#User-binds-DID-to-user’s-wallet" class="headerlink" title="User binds DID to user’s wallet"></a>User binds DID to user’s wallet<a class="article-anchor" href="#User-binds-DID-to-user’s-wallet" aria-hidden="true"></a></h3><ol>
<li><p>Generate multi-signature address<br>Exchange and <code>Alice</code> get public-key of an address of their account by <code>getpublickey</code>. Exchange and <code>Alice</code> swap the public-keys and generate multi-signature addresses by <code>getnewmultisig</code> with the public-keys and parameter <code>m:n</code> valued <code>1:2</code>.</p>
</li>
<li><p>Exchange transfers DID to the multi-signature address<br>Exchange creates a transcation by <code>didchangeaddress</code> to transfer DID named <code>Alias@Alice</code> to the multi-signature address. Exchange broadcasts the transcation by <code>sendrawtx</code>.</p>
</li>
<li><p>User transfers DID from the multi-signature address to wallet<br><code>Alice</code> creates a transcation by <code>didchangeaddress</code> to transfer DID named <code>Alias@Alice</code> from the multi-signature address. <code>Alice</code> broadcasts the transcation by <code>sendrawtx</code>.</p>
</li>
<li><p>Confirmation<br><code>Alice</code> confirms the result by <code>getdid</code>.</p>
</li>
</ol>
<h2 id="DID-micro-service" class="article-heading"><a href="#DID-micro-service" class="headerlink" title="DID micro service"></a>DID micro service<a class="article-anchor" href="#DID-micro-service" aria-hidden="true"></a></h2><hr>
<p>DID micro service provides API for exchanges to process the business logics above.</p>
<ol>
<li><p>Exchange registers DID<br>Exchange generates a new address by <code>getnewaddress</code> and registers DID to it. Exchange saves user’s account ID, DID name and address by micro service api <code>savedid</code>.</p>
</li>
<li><p>Exchange generates a multi-signature address<br>Exchange queries DID name and address with user’s account ID by micro service api <code>querydid</code> when user requests binding DID to user’s wallet. Exchange gets the public key of DID address by <code>getpublickey</code>. After exchange and user swaps their public-keys, exchange generates a multi-signature addresses by <code>getnewmultisig</code>.</p>
</li>
<li><p>Exchange tansfers DID to the multi-signature address<br>Exchange creates a transcation by <code>didchangeaddress</code> to transfer DID to the multi-signature address. Exchange broadcasts the transcation by <code>sendrawtx</code>.</p>
</li>
</ol>
<h2 id="Implementation" class="article-heading"><a href="#Implementation" class="headerlink" title="Implementation"></a>Implementation<a class="article-anchor" href="#Implementation" aria-hidden="true"></a></h2><hr>
<h3 id="User-requests-registering-an-DID-1" class="article-heading"><a href="#User-requests-registering-an-DID-1" class="headerlink" title="User requests registering an DID"></a>User requests registering an DID<a class="article-anchor" href="#User-requests-registering-an-DID-1" aria-hidden="true"></a></h3><p><code>Alice</code> request registering an DID named <code>Alias@Alice</code> on exchange’s website or app.</p>
<h3 id="Exchange-registers-DID-1" class="article-heading"><a href="#Exchange-registers-DID-1" class="headerlink" title="Exchange registers DID"></a>Exchange registers DID<a class="article-anchor" href="#Exchange-registers-DID-1" aria-hidden="true"></a></h3><ol>
<li><p>Exchange generates a new address <code>MLTxV5JAu5sFhQmJYNRmPuu31CkNWrF5rj</code> by <code>getnewaddress</code>.  </p>
 <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Request</span></span><br><span class="line">curl -X POST --data <span class="string">'&#123;</span></span><br><span class="line"><span class="string">    "jsonrpc":"2.0",</span></span><br><span class="line"><span class="string">    "id":8, </span></span><br><span class="line"><span class="string">    "method":"getnewaddress",</span></span><br><span class="line"><span class="string">    "params":[</span></span><br><span class="line"><span class="string">        "Exchange", </span></span><br><span class="line"><span class="string">        "exchangepwd", </span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            "number": 1</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;'</span> http:<span class="comment">//127.0.0.1:8820/rpc/v2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Response</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"id"</span> : <span class="number">8</span>,</span><br><span class="line">    <span class="string">"jsonrpc"</span> : <span class="string">"2.0"</span>,</span><br><span class="line">    <span class="string">"result"</span> : </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"addresses"</span> : </span><br><span class="line">        [</span><br><span class="line">            <span class="string">"MLTxV5JAu5sFhQmJYNRmPuu31CkNWrF5rj"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Exchange sends <code>100000000</code> satoshi(<code>1 ETP</code>) to the new address as fee of registering DID.  </p>
 <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Request</span></span><br><span class="line">curl -X POST --data <span class="string">'&#123;</span></span><br><span class="line"><span class="string">    "id":125,</span></span><br><span class="line"><span class="string">    "jsonrpc":"2.0",</span></span><br><span class="line"><span class="string">    "method":"send",</span></span><br><span class="line"><span class="string">    "params":[</span></span><br><span class="line"><span class="string">        "Exchange", </span></span><br><span class="line"><span class="string">        "exchangepwd", </span></span><br><span class="line"><span class="string">        "MLTxV5JAu5sFhQmJYNRmPuu31CkNWrF5rj",</span></span><br><span class="line"><span class="string">        "100000000"</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;'</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">8820</span>/rpc/v2</span><br><span class="line"></span><br><span class="line"><span class="comment">// Response</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// omit...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Exchange registers DID named <code>Alias@Alice</code> to the new address by <code>registerdid</code>.  </p>
 <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Request</span></span><br><span class="line">curl -X POST -d <span class="string">'&#123;</span></span><br><span class="line"><span class="string">    "id":25,</span></span><br><span class="line"><span class="string">    "jsonrpc":"2.0",</span></span><br><span class="line"><span class="string">    "method":"registerdid",</span></span><br><span class="line"><span class="string">    "params":[</span></span><br><span class="line"><span class="string">        "Exchange", </span></span><br><span class="line"><span class="string">        "exchangepwd", </span></span><br><span class="line"><span class="string">        "MLTxV5JAu5sFhQmJYNRmPuu31CkNWrF5rj",</span></span><br><span class="line"><span class="string">        "Alias@Alice"</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;'</span> http:<span class="comment">//127.0.0.1:8820/rpc/v2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Response</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"id"</span> : <span class="number">25</span>,</span><br><span class="line">    <span class="string">"jsonrpc"</span> : <span class="string">"2.0"</span>,</span><br><span class="line">    <span class="string">"result"</span> : </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"transaction"</span> : </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"hash"</span> : <span class="string">"c350ab69320dc07f7157ae53f82b12c0a0fabafd0c9a381591de22cd24401b7f"</span>,</span><br><span class="line">            <span class="string">"inputs"</span> : </span><br><span class="line">            [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"address"</span> : <span class="string">"MLTxV5JAu5sFhQmJYNRmPuu31CkNWrF5rj"</span>,</span><br><span class="line">                    <span class="string">"previous_output"</span> : </span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="string">"hash"</span> : <span class="string">"9a3e19510089fdc14dd3f0a5e8d252b9271dddfbc41651936bac6c406b8ad15c"</span>,</span><br><span class="line">                        <span class="string">"index"</span> : <span class="number">0</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="string">"script"</span> : <span class="string">"[ 304402205f2b347ded297c384f4b28187d41abafd46f254fbac18f856d5e7337f8e83ef202206775b25a9f5820689dae59df0789e7fd5787a68238914e0ac70504d47e1ad0ba01 ] [ 031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321 ]"</span>,</span><br><span class="line">                    <span class="string">"sequence"</span> : <span class="number">4294967295</span></span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            <span class="string">"lock_time"</span> : <span class="string">"0"</span>,</span><br><span class="line">            <span class="string">"outputs"</span> : </span><br><span class="line">            [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"address"</span> : <span class="string">"MLTxV5JAu5sFhQmJYNRmPuu31CkNWrF5rj"</span>,</span><br><span class="line">                    <span class="string">"attachment"</span> : </span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="string">"address"</span> : <span class="string">"MLTxV5JAu5sFhQmJYNRmPuu31CkNWrF5rj"</span>,</span><br><span class="line">                        <span class="string">"symbol"</span> : <span class="string">"Alias@Alice"</span>,</span><br><span class="line">                        <span class="string">"type"</span> : <span class="string">"did-register"</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="string">"index"</span> : <span class="number">0</span>,</span><br><span class="line">                    <span class="string">"locked_height_range"</span> : <span class="number">0</span>,</span><br><span class="line">                    <span class="string">"script"</span> : <span class="string">"dup hash160 [ 89d56e08bdbcfe40eb7f3b34fe21253669c828b1 ] equalverify checksig"</span>,</span><br><span class="line">                    <span class="string">"value"</span> : <span class="number">0</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"address"</span> : <span class="string">"MGqHvbaH9wzdr6oUDFz4S1HptjoKQcjRve"</span>,</span><br><span class="line">                    <span class="string">"attachment"</span> : </span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="string">"type"</span> : <span class="string">"etp"</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="string">"index"</span> : <span class="number">1</span>,</span><br><span class="line">                    <span class="string">"locked_height_range"</span> : <span class="number">0</span>,</span><br><span class="line">                    <span class="string">"script"</span> : <span class="string">"dup hash160 [ 61fde3bd4e6955c99b16de2d71e2a369888a1c0b ] equalverify checksig"</span>,</span><br><span class="line">                    <span class="string">"value"</span> : <span class="number">80000000</span></span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            <span class="string">"version"</span> : <span class="string">"4"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Exchange saves user’s account ID, DID name and address by micro service api <code>savedid</code>.</p>
</li>
</ol>
<h3 id="User-transfers-DID-to-wallet" class="article-heading"><a href="#User-transfers-DID-to-wallet" class="headerlink" title="User transfers DID to wallet"></a>User transfers DID to wallet<a class="article-anchor" href="#User-transfers-DID-to-wallet" aria-hidden="true"></a></h3><ol>
<li><p>Exchange queries DID <code>Alias@Alice</code> and address <code>MLTxV5JAu5sFhQmJYNRmPuu31CkNWrF5rj</code> with user’s account ID by micro service api <code>querydid</code> when user requests binding DID to user’s wallet.</p>
</li>
<li><p>Exchange gets the public-key <code>031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321</code> of address <code>MLTxV5JAu5sFhQmJYNRmPuu31CkNWrF5rj</code> by <code>getpublickey</code>. Exchange displays the public-key to <code>Alice</code> and <code>Alice</code> records it to generate a multi-signature address later.</p>
 <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Request</span></span><br><span class="line">curl -X POST --data <span class="string">'&#123;</span></span><br><span class="line"><span class="string">    "jsonrpc":"2.0",</span></span><br><span class="line"><span class="string">    "method":"getpublickey",</span></span><br><span class="line"><span class="string">    "id":5,</span></span><br><span class="line"><span class="string">    "params":[</span></span><br><span class="line"><span class="string">        "Exchange", </span></span><br><span class="line"><span class="string">        "exchangepwd", </span></span><br><span class="line"><span class="string">        "MLTxV5JAu5sFhQmJYNRmPuu31CkNWrF5rj"</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;'</span> http:<span class="comment">//127.0.0.1:8820/rpc/v2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Response</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"id"</span> : <span class="number">5</span>,</span><br><span class="line">    <span class="string">"jsonrpc"</span> : <span class="string">"2.0"</span>,</span><br><span class="line">    <span class="string">"result"</span> : </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"address"</span> : <span class="string">"MLTxV5JAu5sFhQmJYNRmPuu31CkNWrF5rj"</span>,</span><br><span class="line">        <span class="string">"public-key"</span> : <span class="string">"031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>Alice</code> gets the public-key <code>0344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0a</code> of address that DID binds to  by <code>getpublickey</code>. <code>Alice</code> commits this public-key to exchange.</p>
 <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Request</span></span><br><span class="line">curl -X POST --data <span class="string">'&#123;</span></span><br><span class="line"><span class="string">    "jsonrpc":"2.0",</span></span><br><span class="line"><span class="string">    "method":"getpublickey",</span></span><br><span class="line"><span class="string">    "id":5,</span></span><br><span class="line"><span class="string">    "params":[</span></span><br><span class="line"><span class="string">        "Alice", </span></span><br><span class="line"><span class="string">        "alicepwd", </span></span><br><span class="line"><span class="string">        "MSqhPipeAZ1Ua9GfNbBi65RPdT7x4iHvwF"</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;'</span> http:<span class="comment">//127.0.0.1:8820/rpc/v2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Response</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"id"</span> : <span class="number">5</span>,</span><br><span class="line">    <span class="string">"jsonrpc"</span> : <span class="string">"2.0"</span>,</span><br><span class="line">    <span class="string">"result"</span> : </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"address"</span> : <span class="string">"MSqhPipeAZ1Ua9GfNbBi65RPdT7x4iHvwF"</span>,</span><br><span class="line">        <span class="string">"public-key"</span> : <span class="string">"0344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0a"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Generate multi-signature address<br>Now, both exchange and <code>Alice</code> have enough information to generate multi-signature address. They generate the same multi-signature address by <code>getnewmultisig</code> with public-keys and parament <code>m:n</code> valued <code>1:2</code>.    </p>
<ul>
<li><p>Exchange generates a multi-signature address <code>35ZW2TFThaK96DzwRwrfq5SRH2u7zfKTCF</code>:  </p>
  <figure class="highlight js"><table><tr><td class="code"><pre><span class="line">curl -X POST --data <span class="string">'&#123;</span></span><br><span class="line"><span class="string">    "id":7,</span></span><br><span class="line"><span class="string">    "jsonrpc":"2.0",</span></span><br><span class="line"><span class="string">    "method":"getnewmultisig",</span></span><br><span class="line"><span class="string">    "params":[</span></span><br><span class="line"><span class="string">        "Exchange", </span></span><br><span class="line"><span class="string">        "exchangepwd", </span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            "publickey": [</span></span><br><span class="line"><span class="string">                "0344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0a"</span></span><br><span class="line"><span class="string">            ],</span></span><br><span class="line"><span class="string">            "selfpublickey": "031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321",</span></span><br><span class="line"><span class="string">            "signaturenum": 1,</span></span><br><span class="line"><span class="string">            "publickeynum": 2</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;'</span> http:<span class="comment">//127.0.0.1:8820/rpc/v2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Response</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"id"</span> : <span class="number">7</span>,</span><br><span class="line">    <span class="string">"jsonrpc"</span> : <span class="string">"2.0"</span>,</span><br><span class="line">    <span class="string">"result"</span> : </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"address"</span> : <span class="string">"35ZW2TFThaK96DzwRwrfq5SRH2u7zfKTCF"</span>,</span><br><span class="line">        <span class="string">"description"</span> : <span class="string">""</span>,</span><br><span class="line">        <span class="string">"index"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="string">"m"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="string">"multisig-script"</span> : <span class="string">"1 [ 031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321 ]  [ 0344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0a ] 2 checkmultisig"</span>,</span><br><span class="line">        <span class="string">"n"</span> : <span class="number">2</span>,</span><br><span class="line">        <span class="string">"public-keys"</span> : </span><br><span class="line">        [</span><br><span class="line">            <span class="string">"031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321"</span>,</span><br><span class="line">            <span class="string">"0344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0a"</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="string">"self-publickey"</span> : <span class="string">"031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>Alice</code> generates a multi-signature address <code>35ZW2TFThaK96DzwRwrfq5SRH2u7zfKTCF</code>:  </p>
  <figure class="highlight js"><table><tr><td class="code"><pre><span class="line">curl -X POST --data <span class="string">'&#123;</span></span><br><span class="line"><span class="string">    "id":7,</span></span><br><span class="line"><span class="string">    "jsonrpc":"2.0",</span></span><br><span class="line"><span class="string">    "method":"getnewmultisig",</span></span><br><span class="line"><span class="string">    "params":[</span></span><br><span class="line"><span class="string">        "Alice", </span></span><br><span class="line"><span class="string">        "alicepwd", </span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            "publickey": [</span></span><br><span class="line"><span class="string">                "031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321"</span></span><br><span class="line"><span class="string">            ],</span></span><br><span class="line"><span class="string">            "selfpublickey": "0344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0a",</span></span><br><span class="line"><span class="string">            "signaturenum": 1,</span></span><br><span class="line"><span class="string">            "publickeynum": 2</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;'</span> http:<span class="comment">//127.0.0.1:8820/rpc/v2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Response</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"id"</span> : <span class="number">7</span>,</span><br><span class="line">    <span class="string">"jsonrpc"</span> : <span class="string">"2.0"</span>,</span><br><span class="line">    <span class="string">"result"</span> : </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"address"</span> : <span class="string">"35ZW2TFThaK96DzwRwrfq5SRH2u7zfKTCF"</span>,</span><br><span class="line">        <span class="string">"description"</span> : <span class="string">""</span>,</span><br><span class="line">        <span class="string">"index"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="string">"m"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="string">"multisig-script"</span> : <span class="string">"1 [ 031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321 ]  [ 0344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0a ] 2 checkmultisig"</span>,</span><br><span class="line">        <span class="string">"n"</span> : <span class="number">2</span>,</span><br><span class="line">        <span class="string">"public-keys"</span> : </span><br><span class="line">        [</span><br><span class="line">            <span class="string">"031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321"</span>,</span><br><span class="line">            <span class="string">"0344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0a"</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="string">"self-publickey"</span> : <span class="string">"0344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0a"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Exchange transfers DID to the multi-signature address  </p>
<ul>
<li><p>Exchange sends <code>10000</code> satoshi(<code>0.0001 ETP</code>) to the multi-signature address as fee of transfering DID later.  </p>
  <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Request</span></span><br><span class="line">curl -X POST --data <span class="string">'&#123;</span></span><br><span class="line"><span class="string">    "id":125,</span></span><br><span class="line"><span class="string">    "jsonrpc":"2.0",</span></span><br><span class="line"><span class="string">    "method":"send",</span></span><br><span class="line"><span class="string">    "params":[</span></span><br><span class="line"><span class="string">        "Exchange", </span></span><br><span class="line"><span class="string">        "exchangepwd", </span></span><br><span class="line"><span class="string">        "35ZW2TFThaK96DzwRwrfq5SRH2u7zfKTCF",</span></span><br><span class="line"><span class="string">        "10000"</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;'</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">8820</span>/rpc/v2</span><br><span class="line"></span><br><span class="line"><span class="comment">// Response</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 略...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Exchange creates a transcation by <code>didchangeaddress</code> to transfer DID <code>Alias@Alice</code> to the multi-signature address <code>35ZW2TFThaK96DzwRwrfq5SRH2u7zfKTCF</code>. Exchange broadcasts the transcation by <code>sendrawtx</code>.  </p>
</li>
<li><p>Exchange creates a transcation:  </p>
  <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Request</span></span><br><span class="line">curl -X POST -d <span class="string">'&#123;</span></span><br><span class="line"><span class="string">    "id":25,</span></span><br><span class="line"><span class="string">    "jsonrpc":"2.0",</span></span><br><span class="line"><span class="string">    "method":"didchangeaddress",</span></span><br><span class="line"><span class="string">    "params":[</span></span><br><span class="line"><span class="string">        "Exchange", </span></span><br><span class="line"><span class="string">        "exchangepwd", </span></span><br><span class="line"><span class="string">        "35ZW2TFThaK96DzwRwrfq5SRH2u7zfKTCF",</span></span><br><span class="line"><span class="string">        "Alias@Alice"</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;'</span> http:<span class="comment">//127.0.0.1:8820/rpc/v2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Response</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"id"</span> : <span class="number">25</span>,</span><br><span class="line">    <span class="string">"jsonrpc"</span> : <span class="string">"2.0"</span>,</span><br><span class="line">    <span class="string">"result"</span> : <span class="string">"0400000002c3acf1058e8ae5341fed5b944fe86b83edecbadc5d386e6a968af6eff6378ae7000000009300483045022100c1cbb2235c057e3fac37d4884a3929009336978d5a1feba27acad3012d7e1f550220009a6385d42d28964ccc85c0416aa448933213875901c64695ac7e70b79f3c51014c475121031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321210344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0a52aeffffffff7f1b4024cd22de9115389a0cfdbafaa0c0122bf853ae57717fc00d3269ab50c3000000006b483045022100f88ea6c345e1164e7bc2331ea11bf0bb795ad104b02b1da394d976751de378ba02203f02e841e27aae877ff1bcd22fd72737586539e3d40e3451661ac32ab686e7690121031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321ffffffff01000000000000000017a9142a74a23b4ed1bb90f575e73c0208106d37eb653a870100000004000000020000000b416c69617340416c6963652233355a573254465468614b3936447a775277726671355352483275377a664b54434600000000"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Exchange broadcasts the transcation:  </p>
  <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Request</span></span><br><span class="line">curl -X POST -d <span class="string">'&#123;</span></span><br><span class="line"><span class="string">    "id":25,</span></span><br><span class="line"><span class="string">    "jsonrpc":"2.0",</span></span><br><span class="line"><span class="string">    "method":"sendrawtx",</span></span><br><span class="line"><span class="string">    "params":[</span></span><br><span class="line"><span class="string">        "0400000002c3acf1058e8ae5341fed5b944fe86b83edecbadc5d386e6a968af6eff6378ae7000000009300483045022100c1cbb2235c057e3fac37d4884a3929009336978d5a1feba27acad3012d7e1f550220009a6385d42d28964ccc85c0416aa448933213875901c64695ac7e70b79f3c51014c475121031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321210344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0a52aeffffffff7f1b4024cd22de9115389a0cfdbafaa0c0122bf853ae57717fc00d3269ab50c3000000006b483045022100f88ea6c345e1164e7bc2331ea11bf0bb795ad104b02b1da394d976751de378ba02203f02e841e27aae877ff1bcd22fd72737586539e3d40e3451661ac32ab686e7690121031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321ffffffff01000000000000000017a9142a74a23b4ed1bb90f575e73c0208106d37eb653a870100000004000000020000000b416c69617340416c6963652233355a573254465468614b3936447a775277726671355352483275377a664b54434600000000"</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;'</span> http:<span class="comment">//127.0.0.1:8820/rpc/v2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Response</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"id"</span> : <span class="number">25</span>,</span><br><span class="line">    <span class="string">"jsonrpc"</span> : <span class="string">"2.0"</span>,</span><br><span class="line">    <span class="string">"result"</span> : </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"hash"</span> : <span class="string">"a981e820071c852710c05bdb70ec2da0da0d877575947aedbcf3ff1d3b7f56c9"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>Alice</code> transfers DID from the multi-signature address<br><code>Alice</code> creates a transcation by <code>didchangeaddress</code> to transfer DID <code>Alias@Alice</code> from the multi-signature address <code>35ZW2TFThaK96DzwRwrfq5SRH2u7zfKTCF</code>. <code>Alice</code> broadcasts the transcation by <code>sendrawtx</code>.  </p>
<ul>
<li><p><code>Alice</code> creates a transcation:  </p>
  <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Request</span></span><br><span class="line">curl -X POST -d <span class="string">'&#123;</span></span><br><span class="line"><span class="string">    "id":25,</span></span><br><span class="line"><span class="string">    "jsonrpc":"2.0",</span></span><br><span class="line"><span class="string">    "method":"didchangeaddress",</span></span><br><span class="line"><span class="string">    "params":[</span></span><br><span class="line"><span class="string">        "Alice", </span></span><br><span class="line"><span class="string">        "alicepwd", </span></span><br><span class="line"><span class="string">        "MSqhPipeAZ1Ua9GfNbBi65RPdT7x4iHvwF",</span></span><br><span class="line"><span class="string">        "Alias@Alice"</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;'</span> http:<span class="comment">//127.0.0.1:8820/rpc/v2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Response</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"id"</span> : <span class="number">25</span>,</span><br><span class="line">    <span class="string">"jsonrpc"</span> : <span class="string">"2.0"</span>,</span><br><span class="line">    <span class="string">"result"</span> : <span class="string">"0400000002c9567f3b1dfff3bced7a947575870ddaa02dec70db5bc01027851c0720e881a9000000009300483045022100adb80306458db15f8e82108f92a3ecf9d0dd221f89386b1d006a09b88dba243c022007a5198bb84f203b6a91bc2fcc7fd5413cfc0e7982dabdc89feb2f3a5cf3405c014c475121031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321210344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0a52aeffffffffb6a654253b99292f7ce585fc718c0e28dbe730c79dded3eb373f9b51ce9ddd0e000000006a47304402205beb823ab2395e8ceecd1595327f3d1f8fe9bec12e6d1e71df94acf29d168bf502204152096109155468fd6f501e5494ac947fba2e7f313ec2b398e6b3aec5eeb59701210344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0affffffff0200000000000000001976a914cfc2bcbdc96854fe00dbe86db689fd1ea918bdd888ac0100000004000000020000000b416c69617340416c696365224d53716850697065415a3155613947664e6242693635525064543778346948767746f07be111000000001976a914cfc2bcbdc96854fe00dbe86db689fd1ea918bdd888ac010000000000000000000000"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>Alice</code> broadcasts the transcation:  </p>
  <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Request</span></span><br><span class="line">curl -X POST -d <span class="string">'&#123;</span></span><br><span class="line"><span class="string">    "id":25,</span></span><br><span class="line"><span class="string">    "jsonrpc":"2.0",</span></span><br><span class="line"><span class="string">    "method":"sendrawtx",</span></span><br><span class="line"><span class="string">    "params":[</span></span><br><span class="line"><span class="string">        "0400000002c9567f3b1dfff3bced7a947575870ddaa02dec70db5bc01027851c0720e881a9000000009300483045022100adb80306458db15f8e82108f92a3ecf9d0dd221f89386b1d006a09b88dba243c022007a5198bb84f203b6a91bc2fcc7fd5413cfc0e7982dabdc89feb2f3a5cf3405c014c475121031c7ac7f12a05ea4952289801fa52142aa421f11efe8ab7090fb823562156a321210344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0a52aeffffffffb6a654253b99292f7ce585fc718c0e28dbe730c79dded3eb373f9b51ce9ddd0e000000006a47304402205beb823ab2395e8ceecd1595327f3d1f8fe9bec12e6d1e71df94acf29d168bf502204152096109155468fd6f501e5494ac947fba2e7f313ec2b398e6b3aec5eeb59701210344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0affffffff0200000000000000001976a914cfc2bcbdc96854fe00dbe86db689fd1ea918bdd888ac0100000004000000020000000b416c69617340416c696365224d53716850697065415a3155613947664e6242693635525064543778346948767746f07be111000000001976a914cfc2bcbdc96854fe00dbe86db689fd1ea918bdd888ac010000000000000000000000"</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;'</span> http:<span class="comment">//127.0.0.1:8820/rpc/v2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Response</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"id"</span> : <span class="number">25</span>,</span><br><span class="line">    <span class="string">"jsonrpc"</span> : <span class="string">"2.0"</span>,</span><br><span class="line">    <span class="string">"result"</span> : </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"hash"</span> : <span class="string">"efbd03e1e25fb7b5a4b153bda5f7fe34bc1a8028f751ee14c93d3a398fa71d8d"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Confirmation<br><code>Alice</code> confirms the result by <code>getdid</code>.</p>
 <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Request</span></span><br><span class="line">curl -X POST --data <span class="string">'&#123;</span></span><br><span class="line"><span class="string">    "jsonrpc":"2.0",</span></span><br><span class="line"><span class="string">    "method":"getdid",</span></span><br><span class="line"><span class="string">    "id":42,</span></span><br><span class="line"><span class="string">    "params":["Alias@Alice"]</span></span><br><span class="line"><span class="string">&#125;'</span>  http:<span class="comment">//127.0.0.1:8820/rpc/v2/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Response</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"id"</span> : <span class="number">42</span>,</span><br><span class="line">    <span class="string">"jsonrpc"</span> : <span class="string">"2.0"</span>,</span><br><span class="line">    <span class="string">"result"</span> : </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"addresses"</span> : </span><br><span class="line">        [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"address"</span> : <span class="string">"MSqhPipeAZ1Ua9GfNbBi65RPdT7x4iHvwF"</span>,</span><br><span class="line">                <span class="string">"status"</span> : <span class="string">"current"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"address"</span> : <span class="string">"35ZW2TFThaK96DzwRwrfq5SRH2u7zfKTCF"</span>,</span><br><span class="line">                <span class="string">"status"</span> : <span class="string">"history"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"address"</span> : <span class="string">"MLTxV5JAu5sFhQmJYNRmPuu31CkNWrF5rj"</span>,</span><br><span class="line">                <span class="string">"status"</span> : <span class="string">"history"</span></span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">"did"</span> : <span class="string">"Alias@Alice"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="Implementation-with-mvs-rpc-python" class="article-heading"><a href="#Implementation-with-mvs-rpc-python" class="headerlink" title="Implementation with mvs_rpc_python"></a>Implementation with mvs_rpc_python<a class="article-anchor" href="#Implementation-with-mvs-rpc-python" aria-hidden="true"></a></h2><hr>
<p>Please refer to <a href="https://github.com/mvshub/mvs_rpc_python/blob/master/tests/exchange_register_avatar.py" target="_blank" rel="noopener">exchange_register_avatar</a>.  </p>
<ul>
<li><p>Key code.</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">account_name = <span class="string">'Exchange'</span>       <span class="comment"># account name of exchange</span></span><br><span class="line">account_pwd = <span class="string">'exchangepwd'</span>     <span class="comment"># password of account</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(<span class="string">'Exchange register evatar example'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#===========================================================================</span></span><br><span class="line">    <span class="comment"># register DID</span></span><br><span class="line">    <span class="comment">#===========================================================================</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># get DID from user</span></span><br><span class="line">    did = input(<span class="string">'Please input the name of DID:'</span>)</span><br><span class="line">    print(<span class="string">'user want to register DID: &#123;&#125;'</span>.format(did))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># generate new address</span></span><br><span class="line">    address = generate_new_address(account_name, account_pwd)</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">None</span> == address:</span><br><span class="line">        print(<span class="string">'Failed to generate new address'</span>)</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line">    print(<span class="string">"generate a new address: &#123;&#125;"</span>.format(address))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># send 1 ETP to the new address</span></span><br><span class="line">    errmsg = send_etp(account_name, account_pwd, address, <span class="number">100000000</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">None</span> != errmsg:</span><br><span class="line">        print(<span class="string">"Failed to send ETP to &#123;&#125;. error: &#123;&#125;"</span>.format(address, errmsg))</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># register DID to the new address</span></span><br><span class="line">    errmsg = register_did(account_name, account_pwd, address, did)</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">None</span> != errmsg:</span><br><span class="line">        print(<span class="string">"Failed to register DID &#123;&#125; to &#123;&#125;. error: &#123;&#125;"</span>.format(did, address, errmsg))</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> wait_mining(did, <span class="keyword">lambda</span> x : get_did(x) == <span class="literal">None</span>):</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"** Successfully registered did &#123;&#125; to &#123;&#125;\n"</span>.format(did, address))</span><br><span class="line"></span><br><span class="line">    <span class="comment">#===========================================================================</span></span><br><span class="line">    <span class="comment"># transfer DID</span></span><br><span class="line">    <span class="comment">#===========================================================================</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># get public key from user</span></span><br><span class="line">    user_public_key = input(<span class="string">"Please input user's public key:"</span>)</span><br><span class="line">    print(<span class="string">"User's public key: &#123;&#125;"</span>.format(user_public_key))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get public key of the new address</span></span><br><span class="line">    self_public_key = get_public_key(account_name, account_pwd, address)</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">None</span> == address:</span><br><span class="line">        print(<span class="string">'Failed to get public key from address &#123;&#125;'</span>.format(address))</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line">    print(<span class="string">"the public key of the address: &#123;&#125;"</span>.format(self_public_key))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># generate multisig address</span></span><br><span class="line">    multisig_address = generate_multisig_address(</span><br><span class="line">        account_name, account_pwd, self_public_key, user_public_key)</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">None</span> == multisig_address:</span><br><span class="line">        print(<span class="string">'Failed to generate multisig address &#123;&#125;'</span>.format(address))</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line">    print(<span class="string">"generate a multisig address: &#123;&#125;"</span>.format(multisig_address))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># send 0.0001 ETP to the multisig address</span></span><br><span class="line">    print(<span class="string">"sending etp to multisig address"</span>)</span><br><span class="line">    errmsg = send_etp(account_name, account_pwd, multisig_address, <span class="number">10000</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">None</span> != errmsg:</span><br><span class="line">        print(<span class="string">"Failed to send ETP to &#123;&#125;. error: &#123;&#125;"</span>.format(address, errmsg))</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> wait_mining(multisig_address, <span class="keyword">lambda</span> x : get_etp(multisig_address) == <span class="number">0</span>):</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># transfer DID to the multisig address</span></span><br><span class="line">    print(<span class="string">"transfering did to multisig address"</span>)</span><br><span class="line">    rawtx = transfer_did(account_name, account_pwd, multisig_address, did)</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">None</span> == rawtx:</span><br><span class="line">        print(<span class="string">"Failed to transfer DID &#123;&#125; to &#123;&#125;.\nerror: &#123;&#125;"</span>.format(did, multisig_address, errmsg))</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    errmsg = broadcast_rawtx(rawtx)</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">None</span> != errmsg:</span><br><span class="line">        print(<span class="string">"Failed to broadcast rawtx &#123;&#125;. error: &#123;&#125;"</span>.format(rawtx, errmsg))</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> wait_mining([did, multisig_address], <span class="keyword">lambda</span> x : get_did(x[<span class="number">0</span>])[<span class="number">0</span>][<span class="string">'address'</span>] != x[<span class="number">1</span>]):</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"** Successfully transfered did &#123;&#125; to &#123;&#125;"</span>.format(did, multisig_address))</span><br></pre></td></tr></table></figure>
</li>
<li><p>Demo:</p>
  <figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Exchange register evatar example</span><br><span class="line">Please input the name <span class="keyword">of</span> DID:<span class="string">'avatar01@Alice'</span></span><br><span class="line">user want to register DID: avatar01@Alice</span><br><span class="line">generate a <span class="keyword">new</span> address: MUfeU351P7ipuUFJcotzQzDesKHHpuiFpA</span><br><span class="line">wait <span class="keyword">for</span> miner to package</span><br><span class="line">** Successfully registered did avatar01@Alice to MUfeU351P7ipuUFJcotzQzDesKHHpuiFpA</span><br><span class="line"></span><br><span class="line">Please input user<span class="string">'s public key:"0344befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0a"</span></span><br><span class="line"><span class="string">User'</span>s public key: <span class="number">0344</span>befcd59670651a6441c00ef26caa104bab8ff9e5ec3f6e9b65bac9194cad0a</span><br><span class="line">the public key <span class="keyword">of</span> the address: <span class="number">034354</span>fb24938a6b061341e9fdae6b35e3391958c52dccdfc27213ae3ae68288b7</span><br><span class="line">generate a multisig address: <span class="number">3</span>H62VSQPshYgxmDqCUbyZcaPCenLfJQrUH</span><br><span class="line">sending etp to multisig address</span><br><span class="line">wait <span class="keyword">for</span> miner to package</span><br><span class="line">transfering did to multisig address</span><br><span class="line">wait <span class="keyword">for</span> miner to package</span><br><span class="line">** Successfully transfered did avatar01@Alice to <span class="number">3</span>H62VSQPshYgxmDqCUbyZcaPCenLfJQrUH</span><br></pre></td></tr></table></figure></li>
</ul>

              </div>
              <footer class="article-footer">
                <time class="article-footer-updated" datetime="2019-06-21T08:07:18.969Z" itemprop="dateModified">Last updated: 2019-06-21</time>
                <a href="sdk.html" class="article-footer-prev" title="SDKs"><i class="fa fa-chevron-left"></i><span>Prev</span></a>
              </footer>
              
<section id="comments">
  <div id="disqus_thread"></div>
</section>
<script>
  var disqus_shortname = 'docs-mvs-org';
  var disqus_url = 'https://docs.mvs.org/baas/baas-did.html';
  var disqus_title = "DID Micro Service";
  var disqus_config = function(){
    this.language = 'en';
  };
  (function(){
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'https://go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

            </div>
          </div>
          <aside id="article-toc" role="navigation">
            <div id="article-toc-inner">
              <strong class="sidebar-title">Contents</strong>
              <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#User-Case"><span class="toc-text">User Case</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#User-requests-registering-an-DID"><span class="toc-text">User requests registering an DID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exchange-registers-DID"><span class="toc-text">Exchange registers DID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#User-binds-DID-to-user’s-wallet"><span class="toc-text">User binds DID to user’s wallet</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DID-micro-service"><span class="toc-text">DID micro service</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Implementation"><span class="toc-text">Implementation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#User-requests-registering-an-DID-1"><span class="toc-text">User requests registering an DID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exchange-registers-DID-1"><span class="toc-text">Exchange registers DID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#User-transfers-DID-to-wallet"><span class="toc-text">User transfers DID to wallet</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Implementation-with-mvs-rpc-python"><span class="toc-text">Implementation with mvs_rpc_python</span></a></li></ol>
              <a href="#" id="article-toc-top">Back to Top</a>
            </div>
          </aside>
        </div>
      </article>
      <aside id="sidebar" role="navigation">
  <div class="inner">
    <strong class="sidebar-title">Introduction</strong><a href="index.html" class="sidebar-link">Introduction</a><strong class="sidebar-title">SDKs</strong><a href="sdk.html" class="sidebar-link">SDKs</a><strong class="sidebar-title">Micro Services</strong><a href="baas-did.html" class="sidebar-link current">Avatar</a>
  </div>
</aside>
    </div>
  </div>
</div>

    <footer id="footer" class="wrapper">
  <div class="inner">
    <div id="footer-copyright">
      &copy; 2020 <a href="https://github.com/mvs-org/metaverse/graphs/contributors" target="_blank">MVS Core Developers</a><br>
      Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>.
    </div>
    <div id="footer-links">
      <a href="https://twitter.com/mvs_org" class="footer-link" target="_blank"><i class="fa fa-twitter"></i></a>
      <a href="https://github.com/mvs-org/metaverse" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a>
    </div>
  </div>
</footer>

  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="/docs/" class="mobile-nav-link">Docs</a><a href="/api_v3/" class="mobile-nav-link">API v3</a><a href="/baas/" class="mobile-nav-link">BaaS</a><a href="/developers/" class="mobile-nav-link">Developers</a><a href="/faq/" class="mobile-nav-link">FAQ</a><a href="/news/" class="mobile-nav-link">Releases</a>
      <li class="mobile-nav-item">
        <a href="https://github.com/mvs-org/metaverse" class="mobile-nav-link" rel="external" target="_blank">GitHub</a>
      </li>
    </ul>
    
      <strong class="mobile-nav-title">Introduction</strong><a href="index.html" class="mobile-nav-link">Introduction</a><strong class="mobile-nav-title">SDKs</strong><a href="sdk.html" class="mobile-nav-link">SDKs</a><strong class="mobile-nav-title">Micro Services</strong><a href="baas-did.html" class="mobile-nav-link current">Avatar</a>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>English</span></span>
    <select id="mobile-lang-select" data-canonical="baas/baas-did.html">
      
        <option value="en" selected>English</option>
      
        <option value="zh-cn">简体中文</option>
      
    </select>
  </div>
</nav>
  <!-- Scripts -->
<!-- build:js build/js/main.js -->
<script src="/js/lang_select.js"></script>
<script src="/js/toc.js"></script>
<script src="/js/mobile_nav.js"></script>
<!-- endbuild -->

<!-- Algolia -->


</body>
</html>